"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var fs=require("fs"),primitives=require("@react-pdf/primitives"),BlobStream=require("blob-stream"),FontStore=require("@react-pdf/font"),renderPDF=require("@react-pdf/render"),PDFDocument=require("@react-pdf/pdfkit"),layoutDocument=require("@react-pdf/layout"),ReactFiberReconciler=require("react-reconciler"),scheduler=require("scheduler");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}}),r.default=e,Object.freeze(r)}var fs__default=_interopDefaultLegacy(fs),primitives__namespace=_interopNamespace(primitives),BlobStream__default=_interopDefaultLegacy(BlobStream),FontStore__default=_interopDefaultLegacy(FontStore),renderPDF__default=_interopDefaultLegacy(renderPDF),PDFDocument__default=_interopDefaultLegacy(PDFDocument),layoutDocument__default=_interopDefaultLegacy(layoutDocument),ReactFiberReconciler__default=_interopDefaultLegacy(ReactFiberReconciler);const propsEqual=(e,r)=>{const t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(let n=0;n<t.length;n+=1){const o=t[n];if("render"===o&&!e[o]!=!r[o])return!1;if("children"!==o&&e[o]!==r[o]){if("object"==typeof e[o]&&"object"==typeof r[o]&&propsEqual(e[o],r[o]))continue;return!1}if("children"===o&&("string"==typeof e[o]||"string"==typeof r[o]))return e[o]===r[o]}return!0},emptyObject={},createRenderer=({onChange:e=(()=>{})})=>ReactFiberReconciler__default.default({schedulePassiveEffects:scheduler.unstable_scheduleCallback,cancelPassiveEffects:scheduler.unstable_cancelCallback,supportsMutation:!0,isPrimaryRenderer:!1,warnsIfNotActing:!1,appendInitialChild(e,r){e.children.push(r)},createInstance:(e,{style:r,children:t,...n})=>({type:e,box:{},style:r||{},props:n||{},children:[]}),createTextInstance:(e,r)=>({type:"TEXT_INSTANCE",value:e}),finalizeInitialChildren:(e,r,t)=>!1,getPublicInstance:e=>e,prepareForCommit(){},prepareUpdate:(e,r,t,n)=>!propsEqual(t,n),resetAfterCommit:e,resetTextContent(e){},getRootHostContext:()=>emptyObject,getChildHostContext:()=>emptyObject,shouldSetTextContent:(e,r)=>!1,now:Date.now,useSyncScheduling:!0,appendChild(e,r){e.children.push(r)},appendChildToContainer(e,r){"ROOT"===e.type?e.document=r:e.children.push(r)},insertBefore(e,r,t){const n=e.children.indexOf(t);-1!==n&&r&&e.children.splice(n,0,r)},removeChild(e,r){const t=e.children.indexOf(r);-1!==t&&e.children.splice(t,1)},removeChildFromContainer(e,r){const t=e.children.indexOf(r);-1!==t&&e.children.splice(t,1)},commitTextUpdate(e,r,t){e.value=t},commitUpdate(e,r,t,n,o){const{style:i,...a}=o;e.props=a,e.style=i}});var version="2.0.0-alpha.15";const fontStore=new FontStore__default.default,pdf=({initialValue:e,onChange:r})=>{const t={type:"ROOT",document:null,lang:"en-US"},n=createRenderer({onChange:r}),o=n.createContainer(t),i=e=>{n.updateContainer(e,o,null)};e&&i(e);const a=()=>{const{document:e}=t;return e.props?e.props.lang:null},l=async()=>{const e=new PDFDocument__default.default({autoFirstPage:!1,lang:a()}),r=await layoutDocument__default.default(t.document,fontStore);return renderPDF__default.default(e,r)},c=(e={})=>{t.document.props.onRender&&t.document.props.onRender(e)};return{container:t,toBlob:async()=>{const e=(await l()).pipe(BlobStream__default.default());return new Promise((r,t)=>{e.on("finish",()=>{try{const n=e.toBlob("application/pdf");c({blob:n}),r(n)}catch(e){t(e)}}),e.on("error",t)})},toBuffer:async()=>(c(),l()),toString:async()=>{let e="";const r=await l();return new Promise((t,n)=>{try{r.on("data",r=>{e+=r}),r.on("end",()=>{t(e)})}catch(e){n(e)}})},updateContainer:i}},Font=fontStore,StyleSheet={create:e=>e},renderToStream=async e=>{const r=pdf({initialValue:e});return await r.toBuffer()},renderToString=e=>{return pdf({initialValue:e}).toString()},renderToFile=async(e,r,t)=>{const n=await renderToStream(e),o=fs__default.default.createWriteStream(r);return n.pipe(o),new Promise((e,i)=>{o.on("finish",()=>{t&&t(n,r),e(n)}),o.on("error",i)})},throwEnvironmentError=e=>{throw new Error(`${e} is a web specific API. You're either using this component on Node, or your bundler is not loading react-pdf from the appropriate web build.`)},PDFViewer=()=>{throwEnvironmentError("PDFViewer")},PDFDownloadLink=()=>{throwEnvironmentError("PDFDownloadLink")},BlobProvider=()=>{throwEnvironmentError("BlobProvider")},render=renderToFile;var node={pdf:pdf,Font:Font,version:version,StyleSheet:StyleSheet,PDFViewer:PDFViewer,BlobProvider:BlobProvider,PDFDownloadLink:PDFDownloadLink,renderToStream:renderToStream,renderToString:renderToString,renderToFile:renderToFile,render:render,...primitives__namespace};Object.keys(primitives).forEach(function(e){"default"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return primitives[e]}})}),exports.BlobProvider=BlobProvider,exports.Font=Font,exports.PDFDownloadLink=PDFDownloadLink,exports.PDFViewer=PDFViewer,exports.StyleSheet=StyleSheet,exports.default=node,exports.pdf=pdf,exports.render=render,exports.renderToFile=renderToFile,exports.renderToStream=renderToStream,exports.renderToString=renderToString,exports.version=version;
//# sourceMappingURL=react-pdf.cjs.min.js.map
